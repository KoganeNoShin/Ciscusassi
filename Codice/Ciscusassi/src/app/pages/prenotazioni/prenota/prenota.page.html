<link
	rel="stylesheet"
	href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
	integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
	crossorigin=""
/>

<ion-content [fullscreen]="true">
	<app-hero
		title="PRENOTAZIONE"
		description="Prenota il tuo tavolo e regalati un'esperienza culinaria senza tempo!"
		[backgroundURL]="'PrenotazioneBackground.jpeg'"
	></app-hero>

	<div class="map-div">
		@if (prenotazioni.length > 0) {
			<h1>PRENOTA UN TAVOLO</h1>
			<p>Hai già una prenotazione!</p>

			@for (prenotazione of prenotazioni; track prenotazione.id_prenotazione) {
				<ion-card class="prenotazione-card">
					<ion-item>
						<ion-icon name="calendar-outline" slot="start"></ion-icon>
						<ion-label>
							{{ prenotazione?.data_ora_prenotazione | date: 'fullDate' }}
							<small>
								{{ prenotazione?.data_ora_prenotazione | date: 'shortTime' }}
							</small>
						</ion-label>
					</ion-item>

					<ion-item>
						<ion-icon name="people-outline" slot="start"></ion-icon>
						<ion-label>{{ prenotazione?.numero_persone }} posti</ion-label>
					</ion-item>

					<ion-button
						color="danger"
						expand="block"
						(click)="cancellaPrenotazione(prenotazione?.id_prenotazione!)"
					>
						Cancella Prenotazione
					</ion-button>
				</ion-card>
			}
		} @else {
			<h1>PRENOTA UN TAVOLO</h1>
			<p>Trova il ristorante più adatto a te!</p>

			<ion-grid>
				<ion-row>
					<ion-col size="6" class="filiali-col">
						<ion-item class="barra-ricerca">
							<ion-input
								placeholder="Indirizzo Filiale"
								[(ngModel)]="searchFiliale"
								(ionInput)="filtroFiliali()"
							></ion-input>
						</ion-item>

						<div class="filiali-list">
							@for (f of filialiFiltrate; track f.id_filiale) {
								<ion-button
									class="filiale"
									(click)="salvaFiliale(f.id_filiale)"
								>
									<ion-row>
										<ion-col size="3">
											<img
												[src]="f.immagine"
												alt="Immagine della Filiale"
												class="immagine-filiale"
											/>
										</ion-col>
										<ion-col size="9">
											<ion-label>
												<h2 class="filiale-comune">
													{{ f.comune }}
												</h2>
												<h2 class="filiale-indirizzo">
													{{ f.indirizzo }}
												</h2>
												<p>12:00 - 15:00<br />19:00 - 22:00</p>
											</ion-label>
										</ion-col>
									</ion-row>
								</ion-button>
							}
						</div>
					</ion-col>

					<ion-col size="6">
						<ion-card class="map-card">
							<div class="map-card-content">
								<app-leaflet-map></app-leaflet-map>
							</div>
						</ion-card>
					</ion-col>
				</ion-row>
			</ion-grid>
		}
	</div>
</ion-content>
